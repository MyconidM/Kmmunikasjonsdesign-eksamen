<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dagligvarebutikker i Halden</title>
    <!-- INCLUDE LEAFLET CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <!-- INCLUDE LEAFLET SCRIPT LIBRARY -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        div, article, section {
            box-sizing: border-box;
        }
        #mapContainer {
            width: 100vw;
            height: 100vh;
            z-index: 1;
            position: fixed;
            top: 0;
            left: 0;

        }
        #scrollContainer {
            width: 100vw;
            height: 100vh;
            z-index: 5;
            padding-bottom: 50vh;
            display: block;
        }
        .scrollBox {
            position: relative;
            display: block;
            margin: 50vh 0 50vh 2rem;
            z-index: 10;
            width: 50%;
            max-width: 400px;
            border: 1px solid #ccc;
            background: #fff;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 2px 2px 2px #ccc;
        }
    </style>
</head>
<body>
    <img scr="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg/2560px-The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg" alt="Seventy Mile Bush">
        
</img>
    <div id="mapContainer"></div>
    <div id="scrollContainer">
        <article class="scrollBox" id="start"><h3>Norsk emigrasjon til New Zealand </h3></article>
        <article class="scrollBox" id="r1000b"><p>New Zealand 1870:
        </p><img scr="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg/2560px-The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg" alt="Seventy Mile Bush">
        
        </img><p>Myndighetene i New Zealand ønsker å utvikle og befolke deler av Nordøyen som er dekket i tett urskog. Det åpnes for at nordmen skal få mulighet til assistert imigrasjon, dette vil si at de blir tilbytt en gratis båttur til New Zealand og en bit med land i bytte mot et par år med arbeid.</p></article>
        <article class="scrollBox" id="SMB"><p>Seventy Mile Bush</p> <img src="https://tararualibrary.files.wordpress.com/2018/03/70milebush.jpg?w=994" alt="Seventy Mile Bush"></article>
        <article class="scrollBox" id="Napier"><p>Napier Port</p></article>
        <article class="scrollBox" id="r1000br"><p>Rema 1000 Brødløs</p></article>
        <article class="scrollBox" id="r1000r"><p>Rema 1000 Risum</p></article>
        <article class="scrollBox" id="end"><p>This is a brief example of combining the visualization templates and map templates using Leaflet for moving the focal point and zoom of a map depending on what information is in the viewport.</p></article>
    </div>

    <script>
        //INITIATE MAP
        const centerLat = -39.48333
        const centerLong = 174.8860
        //let map = L.map('map').setView([centerLat, centerLong], 13);
        let map = L.map('mapContainer', {
            center: [centerLat, centerLong],
            zoom: 10,
            scrollWheelZoom: false
        })
        //SET MAP CONSTRUCTOR
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        //PLACES
        const places = [
            {name: "Seventy Mile Bush", lat: -40.484802, long: 176.012157},
            {name: "Norsewood", lat: -40.0360, long: 176.1260},
            {name: "Rema 1000 Tistedal", lat: 59.1258, long: 11.4450},
            {name: "Napier Port", lat: -39.48333, long: 176.91667},
            {name: "Rema 1000 Svinesundsparken", lat: 59.1282, long: 11.2745}
        ]

        //Function to check if element is in viewport
        function isInViewport(el) {
            const rect = el.getBoundingClientRect();
            return (
                (rect.top <= 0 && rect.bottom >= 0) || 
                (rect.top >= 0 &&
                rect.left >= 0 &&
                rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                rect.right <= (window.innerWidth || document.documentElement.clientWidth))
            );
        }
        //SET MARKERS
        //create custom icon:
        const remaIcon = L.icon({
            iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg/2560px-The_Mangatainoko_River%2C_Seventy_Mile_Bush%2C_N.Z.jpg',
            iconSize: [40,40],
            iconAnchor: [20,20],
            popupAnchor: [0, -20]
        })
        places.map((place) => {
            L.marker([place.lat, place.long], {icon: remaIcon}).addTo(map).bindPopup(place.name)
        })
        //SCRIPT FOR CHANGING MAP LOCATION
        document.addEventListener('scroll', function () {
            if(isInViewport(document.getElementById("start"))) {
                map.flyTo([centerLat, centerLong], 6)
            }
            if(isInViewport(document.getElementById("Napier"))) {
                map.flyTo([-39.48333,176.91667], 12)
            }
            if(isInViewport(document.getElementById("SMB"))) {
                map.flyTo([-40.484802,176.012157], 8)
            }
            if(isInViewport(document.getElementById("r1000t"))) {
                map.flyTo([59.1258, 11.4450], 17)
            }
            if(isInViewport(document.getElementById("r1000br"))) {
                map.flyTo([59.1291, 11.3796], 17)
            }
            if(isInViewport(document.getElementById("r1000r"))) {
                map.flyTo([59.1186, 11.4092], 17)
            }
            if(isInViewport(document.getElementById("start"))) {
                map.flyTo([centerLat, centerLong], 5)
            }
        }, {
            passive: true
        });
    </script>
</body>
</html>
